@model PTT_NGROUR.Models.ViewModel.ModelUtilization
@{
    ViewBag.Title = "Report";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<link href="~/Scripts/DataTables/datatables.min.css" rel="stylesheet" />

<link href="~/Scripts/bootstrap-select-1.12.4/dist/css/bootstrap-select.min.css" rel="stylesheet" />

@section style{
<style>
    .head {
        background-color: #e0e0e0;
    }
</style>}
<br />
<div class="container-fluid" style="margin-top:-.8rem">

    <!--Search Bar -->
    <div class="ph2 ph0-xs">
        <div class=" p-3 mb-2 col-container col-container-white text-dark ">
            <div style="padding-bottom:.5rem;padding-top:.5rem">

                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <span class="col-lg-2 col-md-2 col-sm-2"></span>
                        <span class="col-lg-2 col-md-2 col-sm-3 col-xs-7" style="padding-top:7px;padding-right:0rem">
                            <label class=" ml-5 lato" style="padding-right:6px">
                                <input type="radio" name="radio" id="radioRegion" checked="checked" onclick="javascript:Check();">
                                <span class="checkmark h6 b">Region</span>
                            </label>
                            <label class="d-none ">
                                <input type="radio" name="radio" id="radioLicense" onclick="javascript:Check();">
                                <span class="checkmark h6 b"> License</span>
                            </label>
                        </span>
                        <div class="col-lg-5 col-md-5  col-sm-5 col-xs-7" id="seRegion" style="padding-bottom: 0rem !important">
                            <div class="form-group" style="margin-bottom:5px;">

                                <select class="selectpicker fz-12px form-control fz-12px" name="MultiRegion" id="MultiRegion" multiple data-selected-text-format="count" data-live-search="true" data-actions-box="true" style="margin-bottom:-1rem;">
                                    @foreach (PTT_NGROUR.Models.DataModel.ModelRegion ml in Model.ListRegion)
                                    {
                                        <option value="@ml.REGION_ID" class="text-grey fz-12px" style="word-wrap:break-word;font-size:15px">@ml.REGION_NAME</option>
                                    }
                                </select>
                            </div>
                        </div>


                        <div class="col-lg-5 col-md-5 col-sm-5 col-xs-7" id="seLicense" style="padding-bottom: 0rem !important">
                            <div class="form-group" style="margin-bottom:5px;">
                                <select class="selectpicker fz-12px form-control fz-12px" name="MultiLicense" id="MultiLicense" multiple data-selected-text-format="count" data-live-search="true" data-actions-box="true">
                                    @foreach (PTT_NGROUR.Models.DataModel.ModelLicenseMaster ml in Model.ListLicense)
                                    {
                                        <option class="hidden-sm hidden-xs" value="@ml.LICENSE_ID" style="word-wrap: break-word">@ml.LICENSE</option>
                                        <option class="hidden-lg hidden-md" value="@ml.LICENSE_ID" style="word-wrap: break-word;white-space:normal">@ml.LICENSE</option>
                                    }
                                </select>
                            </div>
                        </div>





                        <span class="col-lg-3 col-md-3 col-sm-3 col-xs-1"></span>
                    </div>
                </div>

            </div>
        </div>

        <!--Search month Year -->
        <div class=" p-3 mb-2 col-container col-container-white text-dark ">
            <div style="padding-bottom:.5rem;padding-top:.5rem">

                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

                        <span class="col-lg-2 col-md-3 col-sm-3 col-xs-7" style="padding-right:0rem;width:190px">
                            <label class="h5">Period &nbsp;</label>
                            <label class=" ml-5 lato" style="padding-right:6px">
                                <input type="radio" name="radioMY" id="radioMonth" checked="checked" onclick="javascript:Check();">
                                <span class="checkmark h6 b">Month</span>
                            </label>
                            <label class="d-none ">
                                <input type="radio" name="radioMY" id="radioYear" onclick="javascript: Check();">
                                <span class="checkmark h6 b">Year</span>
                            </label>
                        </span>
                        <div class="col-lg-2 col-md-2  col-sm-2 col-xs-3" id="chooseMonth" style="padding-bottom: 0rem !important; width: 160px; padding-right: 0rem; ">
                            <div class="form-group" style="margin-bottom:5px; ">

                                <select class="form-control form-control-sm fz-12px" id="Month-filter" style="height: 30px !important;">
                                    <option value="1" class="f5 f8-m drop_role" selected>January</option>
                                    <option value="2" class="f5 drop_role">February</option>
                                    <option value="3" class="f5 drop_role">March</option>
                                    <option value="4" class="f5  drop_role">April</option>
                                    <option value="5" class="f5 f8-m drop_role">May</option>
                                    <option value="6" class="f5 drop_role">June</option>
                                    <option value="7" class="f5 drop_role">July</option>
                                    <option value="8" class="f5  drop_role">August</option>
                                    <option value="9" class="f5 f8-m drop_role">September</option>
                                    <option value="10" class="f5 drop_role">October</option>
                                    <option value="11" class="f5 drop_role">November</option>
                                    <option value="12" class="f5 drop_role">December</option>
                                </select>
                            </div>
                        </div>


                        <div class="col-lg-2 col-md-2 col-sm-2 col-xs-4" id="chooseYear" style="padding-bottom: 0rem !important;padding-right:0rem;">
                            <div class="form-group" style="margin-bottom:5px;">
                                <select class="form-control form-control-sm fz-12px" id="Year-filter" style="height: 30px !important;width:120px ">
                                    <option value="2018" class="5 f8-m drop_role" selected>2018</option>
                                    <option value="2019" class="f5 drop_role">2019</option>
                                    <option value="2020" class="f5 drop_role">2020</option>
                                    <option value="2021" class="f5  drop_role">2021</option>
                                    <option value="2022" class="f5 f8-m drop_role">2022</option>
                                    <option value="2023" class="f5 drop_role">2023</option>
                                    <option value="2024" class="f5 drop_role">2024</option>
                                    <option value="2025" class="f5  drop_role">2025</option>
                                    <option value="2026" class="f5 f8-m drop_role">2026</option>
                                    <
                                </select>
                            </div>
                        </div>

                        <div class="col-lg-2 col-md-2  col-sm-2 col-xs-4" id="chooseYear" style="padding-bottom: 0rem !important; padding-right: 0rem;">
                            <select class="form-control form-control-sm fz-12px" id="type-filter" style="height: 30px !important;">
                                <option id="seAll" class="fz-12px drop_role" value="all">All</option>
                                <option id="sePipeline" class="fz-12px drop_role" value="PIPELINE">Pipeline</option>
                                <option id="seGate" class="fz-12px drop_role" value="GATESTATION">Gate Station</option>

                            </select>
                        </div>
                        <div class="col-lg-2 col-md-2  col-sm-3 col-xs-4" id="chooseYear" style="padding-bottom: 0rem !important; padding-right: 0rem;">
                            <select class="form-control form-control-sm fz-12px" id="threshold-filter" style="height: 30px !important;">
                                <option id="seAllThres" class="fz-12px drop_role" value="all">All Threshold</option>
                                <option id="seGree" class="fz-12px drop_role" value="green">Green</option>
                                <option id="seYello" class="fz-12px drop_role" value="yellow">Yellow</option>
                                <option id="seRed" class="fz-12px drop_role" value="red">Red</option>
                            </select>
                        </div>

                        <span class="col-lg-1 col-md-1 col-sm-1 col-xs-3 ">
                            <button type="button" class="btn btn-primary btn-sm" id="btnSearch" onclick="Search()" style="border-radius:0">
                                <span class="glyphicon glyphicon-search"></span> Search
                            </button>

                        </span>
                        <span class=" pull-right">
                            <span class="col-lg-1 col-md-1 col-sm-1 col-xs-1  ">
                                <i class="fa fa-file-pdf-o fa-lg" aria-hidden="true" style="padding-top:10px"></i>
                            </span>
                        </span>
                        <span class="cr"></span>
                    </div>
                </div>

            </div>
        </div>


        <br />
        <div class="row">

            <div class="col-lg-3 col-md-6 col-sm-6 pb2">
                <div class=" p-3 mb-2 col-container col-container-green text-dark">
                    <div class="ph2" style="padding-bottom:1rem;padding-top:1rem">
                        <div><label class="h6" style="font-size: 14px;">Gate Staton&nbsp;:</label></div>
                        <div><label class="h6" style="font-size: 14px;">Pipeline&nbsp;:</label></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 pb2">
                <div class=" p-3 mb-2 col-container col-container-yellow text-dark">
                    <div class="ph2" style="padding-bottom:1rem;padding-top:1rem">
                        <div><label class="h6" style="font-size: 14px;">Gate Staton&nbsp;:</label></div>
                        <div><label class="h6" style="font-size: 14px;">Pipeline&nbsp;:</label></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 pb2">
                <div class=" p-3 mb-2 col-container col-container-red text-dark">
                    <div class="ph2" style="padding-bottom:1rem;padding-top:1rem">
                        <div><label class="h6" style="font-size: 14px;">Gate Staton&nbsp;:</label></div>
                        <div><label class="h6" style="font-size: 14px;">Pipeline&nbsp;:</label></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 pb2">
                <div class=" p-3 mb-2 col-container col-container-orange text-dark">
                    <div class="ph2" style="padding-bottom:1rem;padding-top:1rem">
                        <div><label class="h6" style="font-size: 14px;">Gate Staton&nbsp;:</label></div>
                        <div><label class="h6" style="font-size: 14px;">Pipeline&nbsp;:</label></div>
                    </div>
                </div>
            </div>
        </div>

     
        <div class="row">
            <div class="col-lg-6 pb2">
                <div class="col-container col-container-white text-dark">
                    <div style="padding-bottom:.5rem;padding-top:.5rem">


                        <div class="col-lg-6 col-md-6 col-sm-6">

                            <div style="font-family: Corbel; font-size: small ;text-align:center " class="row">
                                <center>
                                    <div class="pt5">Gate Station</div>
                                    <div class="pieGraph-lg pieGraph-md pieGraph-sm pieGraph-xs" style="margin-top:-2rem;">
                                        <canvas id="pieGateAll" style="padding: 0;margin: auto;display: block; "> </canvas>

                                    </div>
                                </center>
                            </div>
                        </div>
                        <!--PieLine Donut Graph -->
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <div style="font-family: Corbel; font-size: small ;text-align:center " class="row">
                                <center>
                                    <div class="pt5 ">Pipeline</div>
                                    <div class="pieGraph-lg pieGraph-md pieGraph-sm pieGraph-xs" style="margin-top:-2rem;">
                                        <canvas id="piePipelineAll" style="padding: 0;margin: auto;display: block; "> </canvas>
                                    </div>
                                </center>

                            </div>

                        </div>
                    </div>
                </div>
            </div>


            <div class="col-lg-6 pb2">
                <div class="col-container col-container-white text-dark">
                    <div style="padding-bottom:.5rem;padding-top:.5rem">


                        <div class="col-lg-6 col-md-6 col-sm-6">

                            <div style="font-family: Corbel; font-size: small ;text-align:center " class="row">
                                <center>
                                    <div class="pt5">Gate Station</div>
                                    <div class="pieGraph-lg pieGraph-md pieGraph-sm pieGraph-xs" style="margin-top:-2rem;">
                                      <canvas id="pieGate" style="padding: 0;margin: auto;display: block; "> </canvas>
                                       
                                    </div>
                                </center>
                            </div>
                        </div>
                        <!--PieLine Donut Graph -->
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <div style="font-family: Corbel; font-size: small ;text-align:center " class="row">
                                <center>
                                    <div class="pt5 ">Pipeline</div>
                                    <div class="pieGraph-lg pieGraph-md pieGraph-sm pieGraph-xs" style="margin-top:-2rem;">
                                     <canvas id="piePipeline" style="padding: 0;margin: auto;display: block; "> </canvas>
                                        
                                    </div>
                                </center>

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class=" pb2">
                <div class="col-container col-container-white text-dark">
                    <div style="padding-bottom:.5rem;padding-top:.5rem">
                      
                                <div class="table-responsive">
                                    <table class="table h6 table-striped table-bordered" id="utilTbl">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>Name</th>
                                                <th>Velocity</th>
                                                <th>Color Status</th>
                                                <th>Month/Year</th>
                                                <th>Map</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                           
                                        </tbody>
                                    </table>
                                </div>
                              
                            </div>
                        </div>
                    </div>
        </div>


    </div>
</div>

@section scripts{
<script src="~/Scripts/DataTables/datatables.min.js">
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js" type="text/javascript"></script>
<script src="~/Scripts/Chart/Chart.PieceLabel.min.js"></script>
<script src="~/Scripts/bootstrap-select-1.12.4/dist/js/bootstrap-select.min.js"></script>

  <script>
      $(document).ready(function () {
          document.getElementById('seLicense').style.display = 'none';
          $('#MultiRegion').selectpicker('selectAll');
          $('#utilTbl').DataTable();
      });
    var _graphPipeLine = null;

    var _graphGate = null;

    function Search() {
        let url;

        let multidata;
        let strMode = "";
        if (document.getElementById('radioRegion').checked) {
            url = '@Url.Action("SearchRegion")';
            multidata = SeRegion;
            strMode = "region";
        }
        else if (document.getElementById('radioLicense').checked) {
            url = '@Url.Action("SearchLicense")';
            multidata = SeLicense;
            strMode = "license";
        }
        $.ajax({
            url: url,
            type: 'POST',
            data: JSON.stringify(multidata),
            contentType: 'application/json; charset=utf-8',
            datatype: 'json',
            success: function (data) {
                //console.log(data);
                showPIE("PIPELINE", data);
                showPIE("GATE", data);
                showUtilTable(data);
            },
            error: function (result) {
                alert('Please select the data');
            }
        });
    }

      function showUtilTable(data) {
          let tblShow = $("#utilTbl").DataTable();
          tblShow.clear()
        $('#utilTbl').find('tbody tr').each(function () {
            this.remove();
        });
       
        for (let i in data) {
            num = 1 + Number(i);
            if (document.getElementById('radioMonth').checked)
            { dataMonthYear =data[i].MONTH  + ' / ' + data[i].YEAR ; 
            }
            else if(document.getElementById('radioYear').checked)
            { dataMonthYear = data[i].YEAR; }

            var rowItem = '<tr id="' + data[i].NO + '" class="rowfil" data-color="' + color1 + '" data-type="' + data[i].TYPE + '"><td><h6 class="margin-lr0">' + num + '</h6></td><td><h6 class="margin-lr0">' + data[i].NAME + '</h6></td><td><h6 class="margin-lr0">' + data[i].VALUE + ' %</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td><td><h6 class="margin-lr0">' + dataMonthYear + '</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td></tr>';
            tblShow.row.add($(rowItem));
        } tblShow.draw();
    }

    function showPIE(pStrMode, pListData) {
        let intAlert = 0;
        let intWarning = 0;
        let intPass = 0;
        for (let i in pListData) {
            let data = pListData[i];

            if (data.TYPE !== pStrMode) {
                continue;
            }
            switch (data.COLOR) {
                case "Green":
                    intPass++;
                    break;
                case "Red":
                    intAlert++;
                    break;
                case "Yellow":
                    intWarning++;
                    break;
            }
        }
        let dataT = {
            labels: ["Alert", "Warning", "Pass"],
            datasets: [{
                label: "Test Data",
                data: [intAlert, intWarning, intPass],
                fill: false,
                backgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                hoverBackgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                borderColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                borderWidth: 1
            }]
        };

        let strIdPie = "";
        let objGraph = null;
        if (pStrMode === "PIPELINE") {
            strIdPie = "#piePipeline";
            objGraph = _graphPipeLine;
        } else if (pStrMode === "GATE") {
            strIdPie = "#pieGate";
            objGraph = _graphGate
        }
        if (objGraph != null) {
            objGraph.destroy();
        }
        let ctx = $(strIdPie).get(0).getContext("2d");
        objGraph = new Chart(ctx, {
            type: 'doughnut',
            data: dataT,
            options: {
                responsive: true,
                pieceLabel: { mode: 'value', fontColor: 'white' },
                title: { display: true },
                legend: { position: 'bottom' },
                scales: {
                    xAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' } }],
                    yAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                },
            }
        });
        objGraph.update();
    }

</script>



    <script type="text/javascript">
            var SeRegion;
            var SeLicense;
           

            

            function Check() {

                if (document.getElementById('radioRegion').checked) {
                    document.getElementById('seRegion').style.display = 'inline-block';
                    document.getElementById('seLicense').style.display = 'none';

                }
                else if (document.getElementById('radioLicense').checked) {
                    document.getElementById('seLicense').style.display = 'inline-block';
                    document.getElementById('seRegion').style.display = 'none';
                }
                if (document.getElementById('radioMonth').checked)
                {
                    document.getElementById('chooseMonth').style.display = 'inline-block';
                    document.getElementById('chooseYear').style.display = 'inline-block';
                }
                else if (document.getElementById('radioYear').checked) {
                    document.getElementById('chooseMonth').style.display = 'none';
                   
                }
            }


            var region;
            $('#MultiRegion').change(function () {
                SeRegion = $(this).val();
                // console.log(region);

            })
            $('#MultiLicense').change(function () {
                SeLicense = $(this).val();
                // console.log(region);

            })

            function Search2() {

                let url;
                let graphurl;
                let multidata;
                if (document.getElementById('radioRegion').checked) {
                    url = '@Url.Action("SearchRegion")';
                    graphurl = '@Url.Action("SearchGraphRegion")';
                    multidata = SeRegion;
                }
                else if (document.getElementById('radioLicense').checked) {
                    url = '@Url.Action("SearchLicense")';
                    graphurl = '@Url.Action("SearchGraphLicense")';
                    multidata = SeLicense;
                }
                let tblSearch2 = $("#utilTbl").DataTable();
                tblSearch2.clear()
                $.ajax({
                    url: url,
                    type: 'POST',
                    data: JSON.stringify(multidata),
                    contentType: 'application/json; charset=utf-8',
                    datatype: 'json',
                    success: function (data) {
                        $('#utilTbl').find('tbody tr').each(function () {
                            this.remove();
                        });

                        
                        for (let i in data) {
                            if (data[i].COLOR == 'Green') {
                               
                                color1 = "green"
                                //console.log(color1);
                            } else if (data[i].COLOR == 'Yellow') {
                              
                                color1 = "yellow"
                                //console.log(color1);
                            } else if (data[i].COLOR == 'Red') {
                              
                                color1 = "red"
                            } else {
                                
                                color1 = "no"
                            }
                            //console.log('color1' + color1);
                            //console.log('data' + data[i].NO);

                            num = 1 + Number(i);
                            if (document.getElementById('radioMonth').checked) {
                                dataMonthYear = data[i].MONTH + ' / ' + data[i].YEAR;
                            }
                            else if (document.getElementById('radioYear').checked)
                            { dataMonthYear = data[i].YEAR; }
                            var rowItemSearch2 = '<tr id="' + data[i].NO + '" class="rowfil" data-color="' + color1 + '" data-type="' + data[i].TYPE + '"><td><h6 class="margin-lr0">' + num + '</h6></td><td><h6 class="margin-lr0">' + data[i].NAME + '</h6></td><td><h6 class="margin-lr0">' + data[i].VALUE + ' %</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td><td><h6 class="margin-lr0">' + dataMonthYear + '</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td></tr>';
                            tblSearch2.row.add($(rowItemSearch2));
                        } tblSearch2.draw();
                    },
                    error: function (result) {
                        alert('Please select the data');
                    }
                });

                Chart.defaults.global.legend.labels.usePointStyle = true;
                Chart.defaults.doughnutLabels = Chart.helpers.clone(Chart.defaults.doughnut);
                var helpers = Chart.helpers;
                var defaults = Chart.defaults;
                $.ajax({
                    type: "POST",
                    url: graphurl,
                    data: JSON.stringify(multidata),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (chData) {
                        var aData = chData;
                        var aLabels = aData[0];
                        var aDatasets1 = aData[1];
                        var dataT = {
                            labels: aLabels,
                            datasets: [{
                                label: "Test Data",
                                data: aDatasets1,
                                fill: false,
                                backgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                                hoverBackgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                                borderColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                                borderWidth: 1
                            }]
                        };
                        var ctx = $("#pieGate").get(0).getContext("2d");
                        var myNewChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: dataT,
                            options: {
                                responsive: true,
                                pieceLabel: { mode: 'value', fontColor: 'white' },
                                title: { display: true },
                                legend: { position: 'bottom' },
                                scales: {
                                    xAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' } }],
                                    yAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                                },
                            }
                        });
                    }
                });

                $.ajax({
                    type: "POST",
                    url: graphurl,
                    data: JSON.stringify(multidata),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (chData) {
                        var aData = chData;
                        var aLabels = aData[0];
                        var aDatasets1 = aData[1];
                        var dataT = {
                            labels: aLabels,
                            datasets: [{
                                label: "Test Data",
                                data: aDatasets1,
                                fill: false,
                                backgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                                hoverBackgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                                borderColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                                borderWidth: 1
                            }]
                        };
                        var ctx = $("#piePipeline").get(0).getContext("2d");
                        var myNewChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: dataT,
                            options: {
                                responsive: true,
                                pieceLabel: { mode: 'value', fontColor: 'white' },
                                title: { display: true },
                                legend: { position: 'bottom' },
                                scales: {
                                    xAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' } }],
                                    yAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                                },
                            }
                        });
                    }
                });


            }
            //function searcch
            function myFunction() {
                var input, filter, table, tr, td, i;
                input = document.getElementById("txtSearch");
                filter = input.value.toUpperCase();
                table = document.getElementById("utilTbl");
                tr = table.getElementsByTagName("tr");
                for (i = 0; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td")[1];
                    if (td) {
                        if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                            tr[i].style.display = "";
                        } else {
                            tr[i].style.display = "none";
                        }
                    }
                }
            }

            //////////////////////

            //$("#threshold-filter").change(function () {
            //    console.clear();
            //    var filterValue = $(this).val();
            //    var row = $('.rowfil');

            //    row.each(function (i, el) {
            //        if ($(el).attr('data-color') == filterValue) {
            //            row.hide()
            //            $(el).show();
            //        }
            //    });
            //    // In Addition to Wlin's Answer (For "All" value)
            //    if ("all" == filterValue) {
            //        row.show();
            //    }

            //});

            var
      filters = {
          color: null,
      };
           
        

            function updateFilters() {
                $('.rowfil').hide().filter(function () {
                    var
                      self = $(this),
                      result = true; // not guilty until proven guilty

                    Object.keys(filters).forEach(function (filter) {
                        if (filters[filter] && (filters[filter] != 'all') && (filters[filter] != 'Any')) {
                            result = result && filters[filter] === self.data(filter);
                        }
                    });

                    return result;
                }).show();
            }

            function changeFilter(filterName) {
                filters[filterName] = this.value;
                updateFilters();
            }

            // Threshold Dropdown Filter
            $('#threshold-filter').on('change', function () {
                changeFilter.call(this, 'color');
            });
        // Month Dropdown Filter
            $('#Month-filter').on('change', function () {
                changeFilter.call(this, 'month');
            });

            // Year Dropdown Filter
            $('#Year-filter').on('change', function () {
                changeFilter.call(this, 'year');
            });

            // Type Dropdown Filter
            $('#type-filter').on('change', function () {
                changeFilter.call(this, 'type');
            });



            //////////////////////

    </script>
    <script>
        Chart.defaults.global.legend.labels.usePointStyle = true;
        Chart.defaults.doughnutLabels = Chart.helpers.clone(Chart.defaults.doughnut);
        var helpers = Chart.helpers;
        var defaults = Chart.defaults;
        $.ajax({
            type: "POST",
            url: "/Dashboard/AllGate",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (chData) {
                //console.log(chData);
                var aData = chData;
                var aLabels = aData[0];
                var aDatasets1 = aData[1];
                var dataT = {
                    labels: aLabels,
                    datasets: [{
                        label: "Test Data",
                        data: aDatasets1,
                        fill: false,
                        backgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                        hoverBackgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                        borderColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                        borderWidth: 1
                    }]
                };
                var ctx = $("#pieGateAll").get(0).getContext("2d");
                var myNewChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: dataT,
                    options: {
                        responsive: true,
                        pieceLabel: { mode: 'value', fontColor: 'white' },
                        title: { display: true },
                        legend: { position: 'bottom' },
                        scales: {
                            xAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' } }],
                            yAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                        },
                    }
                });
            }
        });

        $.ajax({
            type: "POST",
            url: "/Dashboard/AllPipeline",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (chData) {
                var aData = chData;
                var aLabels = aData[0];
                var aDatasets1 = aData[1];
                var dataT = {
                    labels: aLabels,
                    datasets: [{
                        label: "Test Data",
                        data: aDatasets1,
                        fill: false,
                        backgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                        hoverBackgroundColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                        borderColor: ["#e74c3c", "#f1c40f", "#16a085", "#e67e22"],
                        borderWidth: 1
                    }]
                };
                var ctx = $("#piePipelineAll").get(0).getContext("2d");
                var myNewChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: dataT,
                    options: {
                        responsive: true,
                        pieceLabel: { mode: 'value', fontColor: 'white' },
                        title: { display: true },
                        legend: { position: 'bottom' },
                        scales: {
                            xAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' } }],
                            yAxes: [{ gridLines: { display: false }, display: false, scaleLabel: { display: false, labelString: '' }, ticks: { stepSize: 50, beginAtZero: true } }]
                        },
                    }
                });
            }
        });

        //////////////////////////////////////
        let tblRegionAll = $("#utilTbl").DataTable();
        tblRegionAll.clear()
        $.ajax({
            url: "/Dashboard/SearchRegionAll",
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            datatype: 'json',
            success: function (data) {
                $('#utilTbl').find('tbody tr').each(function () {
                    this.remove();
                });
                
                for (let i in data) {
                    if (data[i].COLOR == 'Green') {
                        
                        color1 = "green"
                        //console.log(color1);
                    } else if (data[i].COLOR == 'Yellow') {
                     
                        color1 = "yellow"
                        //console.log(color1);
                    } else if (data[i].COLOR == 'Red') {
                      
                        color1 = "red"
                    } else {
           
                        color1 = "no"
                    }
                    //console.log('color1' + color1);
                    //console.log('data' + data[i].NO);

                    num = 1 + Number(i);
                    if (document.getElementById('radioMonth').checked) {
                        dataMonthYear = data[i].MONTH + ' / ' + data[i].YEAR;
                    }
                    else if (document.getElementById('radioYear').checked)
                    { dataMonthYear = data[i].YEAR; }
                    var rowItemRegionAll = '<tr id="' + data[i].NO + '" class="rowfil" data-color="' + color1 + '" data-type="' + data[i].TYPE + '"><td><h6 class="margin-lr0">' + num + '</h6></td><td><h6 class="margin-lr0">' + data[i].NAME + '</h6></td><td><h6 class="margin-lr0">' + data[i].VALUE + ' %</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td><td><h6 class="margin-lr0">' + dataMonthYear + '</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td></tr>';
                    tblRegionAll.row.add($(rowItemRegionAll));
                    //$('#utilTbl > tbody:last-child').append('<tr id="' + data[i].NO + '" class="rowfil" data-color="' + color1 + '" data-type="' + data[i].TYPE + '"><td><h6 class="margin-lr0">' + num + '</h6></td><td><h6 class="margin-lr0">' + data[i].NAME + '</h6></td><td><h6 class="margin-lr0">' + data[i].VALUE + ' %</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td><td><h6 class="margin-lr0">' + dataMonthYear + '</h6></td><td><h6 class="margin-lr0">' + data[i].COLOR + '</h6></td></tr>');
                }
                tblRegionAll.draw();
            },
            error: function (result) {
                alert('Please select the data');
            }
        });
    </script>
    
}


